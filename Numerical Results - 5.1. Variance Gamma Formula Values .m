%%  NUMERICAL RESULTS - 5.1. VARIANCE GAMMA FORMULA VALUES %%


%%  VARIANCE GAMMA FORMULA  %%


% Variance Gamma Parameters:
C = 1.3574;
G = 5.8704;
M = 14.2699;

% General Parameters 
S0 = 1124.47;
r = 0.019;
q = 0.012;

% Times to Maturity:
tau= [(30 - 18)/365, (7-6)/12+ (30 - 18)/365, (7-3)/12+ (30 - 18)/365, (7)/12+ (30 - 18)/365, (7+3)/12+ (30 - 18)/365, (7+6)/12+ (30 - 18)/365, (7+12)/12+ (30 - 18)/365];

% Strike Prices:
K =[975;
    995;
    1025;
    1050;
    1075;
    1090;
    1100;
    1110;
    1120;
    1125;
    1130;
    1135;
    1140;
    1150;
    1160;
    1170;
    1175;
    1200;
    1225;
    1250;
    1275;
    1300;
    1325;
    1350;
    1400;
    1450;
    1500];

% Parameters for the Variance Gamma formula:
n=21;
m=26;
k=7;

% Call Option prices for the Variace Gamma formula computation:
[COP,POP,lo,mu]  = VarianceGammaSumFormula(C, G, M, S0, K, r ,q, tau, n, m, k);
fprintf('Call Option prices for the Variace Gamma formula:')
COP

% Actual Values of the Call Option:
Data = [     0      0 161.60 173.30      0      0      0;
             0      0 144.80 157.00      0 182.10      0;
             0      0 120.10 114.80 146.50      0      0;
             0  84.50 100.70 114.80      0 143.00 171.40;
             0  64.30  82.50  97.60      0      0      0;
         43.10      0      0      0      0      0      0;
         35.60      0  65.50  81.20  96.20 111.30 140.40;
             0  39.50      0      0      0      0      0;
         22.90  33.50      0      0      0      0      0;
         20.20  30.70  51.00  66.90  81.70  97.00      0;
             0  28.00      0      0      0      0      0;
             0  25.60  45.50      0      0      0      0;
         13.30  23.20      0  58.90      0      0      0;
             0  19.10  38.10  53.90  68.30  83.30 112.80;
             0  15.30      0      0      0      0      0;
             0  12.10      0      0      0      0      0;
             0  10.90  27.70  42.50  56.60      0  99.80;
             0      0  19.60  33.00  46.10  60.90      0;
             0      0  13.20  24.90  36.90  49.80      0;
             0      0      0  18.30  29.30  41.20  66.90;
             0      0      0  13.20  22.50      0      0;
             0      0      0      0  17.20  27.10  49.50;
             0      0      0      0  12.80      0      0;
             0      0      0      0      0  17.10  35.70;
             0      0      0      0      0  10.10  25.20;
             0      0      0      0      0      0  17.00;
             0      0      0      0      0      0  12.20];
             
            
% Root Mean Square Error for the Variace Gamma formula:
err = RMSE(Data,COP);
fprintf('Root Mean Square Error for the Variace Gamma formula:')
err

%%  VARIANCE GAMMA MONTE CARLO SIMULATION  %%


% General Parameters:
C = 1.3574;
G = 5.8704;
M = 14.2699;
S0 = 1124.47;
r = 0.019;
q = 0.012;

% Time to Maturity:
tau = [(30 - 18)/365, (7-6)/12+ (30 - 18)/365, (7-3)/12+ (30 - 18)/365, (7)/12+ (30 - 18)/365, (7+3)/12+ (30 - 18)/365, (7+6)/12+ (30 - 18)/365, (7+12)/12+ (30 - 18)/365];

% Strike Prices:
K =[975;
    995;
    1025;
    1050;
    1075;
    1090;
    1100;
    1110;
    1120;
    1125;
    1130;
    1135;
    1140;
    1150;
    1160;
    1170;
    1175;
    1200;
    1225;
    1250;
    1275;
    1300;
    1325;
    1350;
    1400;
    1450;
    1500];

% Parameters for the Monte Carlo Simulation:
dt=0.0001;
ite = 10000;

% Call Option prices for the Variace Gamma Monte Carlo simulation:
COP = CallOptionMonteCarlo(C, G, M, S0, K, r ,q, tau, dt, ite);
fprintf('Call Option prices for the Variace Gamma Monte Carlo simulation:')
COP

% Actual Values of the Call Option:
Data = [     0      0 161.60 173.30      0      0      0;
             0      0 144.80 157.00      0 182.10      0;
             0      0 120.10 114.80 146.50      0      0;
             0  84.50 100.70 114.80      0 143.00 171.40;
             0  64.30  82.50  97.60      0      0      0;
         43.10      0      0      0      0      0      0;
         35.60      0  65.50  81.20  96.20 111.30 140.40;
             0  39.50      0      0      0      0      0;
         22.90  33.50      0      0      0      0      0;
         20.20  30.70  51.00  66.90  81.70  97.00      0;
             0  28.00      0      0      0      0      0;
             0  25.60  45.50      0      0      0      0;
         13.30  23.20      0  58.90      0      0      0;
             0  19.10  38.10  53.90  68.30  83.30 112.80;
             0  15.30      0      0      0      0      0;
             0  12.10      0      0      0      0      0;
             0  10.90  27.70  42.50  56.60      0  99.80;
             0      0  19.60  33.00  46.10  60.90      0;
             0      0  13.20  24.90  36.90  49.80      0;
             0      0      0  18.30  29.30  41.20  66.90;
             0      0      0  13.20  22.50      0      0;
             0      0      0      0  17.20  27.10  49.50;
             0      0      0      0  12.80      0      0;
             0      0      0      0      0  17.10  35.70;
             0      0      0      0      0  10.10  25.20;
             0      0      0      0      0      0  17.00;
             0      0      0      0      0      0  12.20];
             
            
% Root Mean Square Error for the Variace Gamma Monte Carlo simulation:
err = RMSE(Data,COP);
fprintf('Root Mean Square Error for the Variace Gamma Monte Carlo simulation:')
err

%%  EXAMPLE OF AN OPTION PRICE SIMULATION VALUES  %%


% One of the results for the Call option price under 
% the Variancr Gamma Monte Carlo simulation:
fprintf('Call Option prices for the Monte Carlo simulation example:')
COP = [150.9338  154.1386  165.4327  176.5056  186.0899  191.5771  207.8953;
       131.2228  135.1126  147.8636  159.9540  170.4864  176.7852  193.9641;
       101.7677  106.9565  122.2659  136.0264  148.0129  155.5177  173.9746;
        77.3967   83.9257  101.8387  116.9962  130.2694  138.7053  158.1839;
        53.2295   61.5195   82.3795   98.9416  113.4332  122.7825  143.2422;
        38.8793   48.4998   71.2676   88.6256  103.8167  113.6943  134.6732;
        29.4239   40.0590   64.1323   81.9962   97.5839  107.8296  129.1236;
        20.1001   31.8624   57.2328   75.5777   91.5120  102.1267  123.6965;
        11.0008   23.9963   50.6139   69.3718   85.6022   96.5918  118.4066;
         6.5930   20.2143   47.4094   66.3455   82.7198   93.8831  115.8130;
         3.1120   16.5738   44.2858   63.3719   79.8885   91.2106  113.2580;
         2.6233   13.1306   41.2412   60.4699   77.1072   88.5772  110.7345;
         2.2847   10.0264   38.2881   57.6360   74.3771   85.9809  108.2465;
         1.8003    7.5219   32.6676   52.1652   69.0876   80.9113  103.3695;
         1.4634    6.0360   27.5015   46.9729   64.0157   76.0031   98.6201;
         1.2062    4.9530   22.9254   42.0652   59.1581   71.2716   94.0094;
         1.0959    4.5172   20.9184   39.7245   56.8083   68.9759   91.7544;
         0.7092    3.0015   14.0916   29.4298   45.9587   58.2289   81.0090;
         0.4814    2.0759    9.9064   21.7179   36.6188   48.6342   71.1013;
         0.3239    1.4939    7.1196   16.2649   28.8611   40.2009   62.0264;
         0.2072    1.0782    5.1797   12.2946   22.6996   32.9727   53.8515;
         0.1371    0.8106    3.8254    9.3523   17.7736   26.9326   46.5085;
         0.0937    0.6249    2.8732    7.1291   13.9256   21.9685   39.9943;
         0.0607    0.4839    2.1707    5.4231   10.9954   17.8910   34.2548;
         0.0261    0.2884    1.2651    3.1888    6.8960   11.8418   24.9208;
         0.0079    0.1912    0.7340    1.9072    4.3395    7.8263   17.8847;
         0.0000    0.1424    0.4052    1.1442    2.7728    5.1560   12.7505]
         
% Actual Values of the Call Option:
Data = [     0      0 161.60 173.30      0      0      0;
             0      0 144.80 157.00      0 182.10      0;
             0      0 120.10 114.80 146.50      0      0;            
             0  84.50 100.70 114.80      0 143.00 171.40;
             0  64.30  82.50  97.60      0      0      0;
         43.10      0      0      0      0      0      0;
         35.60      0  65.50  81.20  96.20 111.30 140.40;
             0  39.50      0      0      0      0      0;
         22.90  33.50      0      0      0      0      0;
         20.20  30.70  51.00  66.90  81.70  97.00      0;
             0  28.00      0      0      0      0      0;
             0  25.60  45.50      0      0      0      0;
         13.30  23.20      0  58.90      0      0      0;
             0  19.10  38.10  53.90  68.30  83.30 112.80;
             0  15.30      0      0      0      0      0;
             0  12.10      0      0      0      0      0;
             0  10.90  27.70  42.50  56.60      0  99.80;
             0      0  19.60  33.00  46.10  60.90      0;
             0      0  13.20  24.90  36.90  49.80      0;
             0      0      0  18.30  29.30  41.20  66.90;
             0      0      0  13.20  22.50      0      0;
             0      0      0      0  17.20  27.10  49.50;
             0      0      0      0  12.80      0      0;
             0      0      0      0      0  17.10  35.70;
             0      0      0      0      0  10.10  25.20;
             0      0      0      0      0      0  17.00;
             0      0      0      0      0      0  12.20];
             
% Root Mean Square Error for the Monte Carlo simulation example:
err = RMSE(Data,COP);
fprintf('Root Mean Square Error for the Monte Carlo simulation example:')
err

%%  BLACK-SCHOLES FORMULA  %%


% General Parameters:
S0 = 1124.47;
r = 0.019;
q = 0.012;

% Volatility:
sig = 0.1812;

% Times to Maturity:
tau= [(30 - 18)/365, (7-6)/12+ (30 - 18)/365, (7-3)/12+ (30 - 18)/365, (7)/12+ (30 - 18)/365, (7+3)/12+ (30 - 18)/365, (7+6)/12+ (30 - 18)/365, (7+12)/12+ (30 - 18)/365];

% Strike Prices:
K =[975;
    995;
    1025;
    1050;
    1075;
    1090;
    1100;
    1110;
    1120;
    1125;
    1130;
    1135;
    1140;
    1150;
    1160;
    1170;
    1175;
    1200;
    1225;
    1250;
    1275;
    1300;
    1325;
    1350;
    1400;
    1450;
    1500];

% Call Option prices for the Black-Scholes model computation:
[Call, Put, Delta, Gamma, Rho, Theta] = BlackScholes(S0, K, r, q, tau, sig);
fprintf('Call Option prices for the Black-Scholes model:')
Call


% Actual Values of the Call Option:
Data = [     0      0 161.60 173.30      0      0      0;
             0      0 144.80 157.00      0 182.10      0;
             0      0 120.10 114.80 146.50      0      0;            
             0  84.50 100.70 114.80      0 143.00 171.40;
             0  64.30  82.50  97.60      0      0      0;
         43.10      0      0      0      0      0      0;
         35.60      0  65.50  81.20  96.20 111.30 140.40;
             0  39.50      0      0      0      0      0;
         22.90  33.50      0      0      0      0      0;
         20.20  30.70  51.00  66.90  81.70  97.00      0;
             0  28.00      0      0      0      0      0;
             0  25.60  45.50      0      0      0      0;
         13.30  23.20      0  58.90      0      0      0;
             0  19.10  38.10  53.90  68.30  83.30 112.80;
             0  15.30      0      0      0      0      0;
             0  12.10      0      0      0      0      0;
             0  10.90  27.70  42.50  56.60      0  99.80;
             0      0  19.60  33.00  46.10  60.90      0;
             0      0  13.20  24.90  36.90  49.80      0;
             0      0      0  18.30  29.30  41.20  66.90;
             0      0      0  13.20  22.50      0      0;
             0      0      0      0  17.20  27.10  49.50;
             0      0      0      0  12.80      0      0;
             0      0      0      0      0  17.10  35.70;
             0      0      0      0      0  10.10  25.20;
             0      0      0      0      0      0  17.00;
             0      0      0      0      0      0  12.20];
             
% Root Mean Square Error for the Black-Scholes model:
err = RMSE(Data,Call);
fprintf('Root Mean Square Error for the Black-Scholes model:')
err
